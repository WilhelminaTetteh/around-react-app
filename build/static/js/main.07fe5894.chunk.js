(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{26:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(14),i=n.n(o),s=n(6),r=(n(26),n(19)),l=n(2),u=n.p+"static/media/logo.4e8e0a1d.svg",d=n(3),j=n(0);var m=function(e){var t=e.email,n=e.handleLogOut,a=e.loggedIn,c=Object(d.h)();return Object(j.jsxs)("header",{className:"header",children:[Object(j.jsx)("img",{className:"logo",src:u,alt:"logo"}),a&&Object(j.jsxs)("div",{className:"header__nav",children:[Object(j.jsx)("p",{className:"header__email",children:t}),Object(j.jsx)(s.b,{to:"/signin",onClick:n,className:"header__signup",children:"Log out"})]}),!a&&Object(j.jsx)("div",{className:"header__nav",children:"/signin"===c.pathname?Object(j.jsx)(s.b,{to:"/signup",className:"header__signup",children:"Sign up"}):Object(j.jsx)(s.b,{to:"/signin",className:"header__signup",children:"Sign in"})})]})};var b=function(){return Object(j.jsx)("footer",{className:"footer",children:Object(j.jsx)("p",{className:"footer__copyright",children:"\xa9 2021 Around The U.S."})})},h=n.p+"static/media/pencil.8667ac4a.svg",p=n.p+"static/media/add.d86bb2ed.svg",_=c.a.createContext();var f=function(e){var t=c.a.useContext(_),n=e.card.owner._id===t._id,a="grid__delete-icon ".concat(n?"grid__delete-show":"grid__delete-hide"),o=e.card.likes.some((function(e){return e._id===t._id})),i="grid__icon ".concat(o?"grid__icon_active":"");return Object(j.jsx)("div",{className:"grid__template",children:Object(j.jsxs)("li",{className:"grid__item",children:[Object(j.jsx)("button",{type:"button","aria-label":"modal button",className:a,onClick:function(){e.onCardDelete(e.card)}}),Object(j.jsx)("div",{className:"grid__image",style:{backgroundImage:"url(".concat(e.card.link,")")},onClick:function(){e.onCardClick(e.card)}}),Object(j.jsxs)("div",{className:"grid__caption",children:[Object(j.jsx)("p",{className:"grid__text",children:e.card.name}),Object(j.jsxs)("div",{className:"grid__like-column",children:[Object(j.jsx)("button",{className:i,onClick:function(){e.onCardLike(e.card)},"aria-label":"grid icon",type:"button"}),Object(j.jsx)("p",{className:"grid__likes",children:e.card.likes.length})]})]})]})})};var O=function(e){var t=c.a.useContext(_);return Object(j.jsxs)("main",{className:"main",children:[Object(j.jsxs)("section",{className:"profile",children:[Object(j.jsxs)("div",{className:"avatar",onClick:e.onEditAvatarClick,children:[Object(j.jsx)("img",{src:t.avatar,alt:"profile avatar",className:"profile__image"}),Object(j.jsx)("div",{className:"avatar__overlay"})]}),Object(j.jsxs)("div",{className:"profile__info",children:[Object(j.jsxs)("div",{className:"profile__title-container",children:[Object(j.jsx)("h1",{className:"profile__title",children:t.name}),Object(j.jsx)("button",{onClick:e.onEditProfileClick,className:"profile__edit",type:"button","aria-label":"edit button",children:Object(j.jsx)("img",{className:"profile__edit-icon",src:h,alt:"pencil icon"})})]}),Object(j.jsx)("p",{className:"profile__description",children:t.about})]}),Object(j.jsx)("button",{className:"profile__add",type:"button","aria-label":"add",onClick:e.onAddPlaceClick,children:Object(j.jsx)("img",{className:"profile__add-icon",src:p,alt:"plus sign"})})]}),Object(j.jsx)("section",{className:"grid",children:Object(j.jsx)("ul",{className:"grid__container",children:e.cards.map((function(t,n){return Object(j.jsx)(f,{card:t,onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete},n)}))})})]})};var g=function(e){return Object(j.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_open":""),children:Object(j.jsxs)("div",{className:"modal__container",children:[Object(j.jsx)("button",{className:"modal__button",type:"button","aria-label":"modal button",onClick:e.onClose}),Object(j.jsxs)("form",{action:"#",className:"form",method:"POST",name:e.name,onSubmit:e.onSubmit,children:[Object(j.jsx)("h2",{className:"form__heading",children:"".concat(e.title)}),e.children,Object(j.jsx)("button",{className:"form__button ",type:"submit",children:e.buttonText})]})]})})};var x=function(e){return Object(j.jsxs)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_open":""),children:[Object(j.jsx)("button",{className:"modal__button modal__button_type_popup-image",type:"button","aria-label":"modal button",onClick:e.onClose}),Object(j.jsxs)("figure",{className:"modal__figure",children:[Object(j.jsx)("img",{className:"modal__image",src:e.card.link,alt:"place popup"}),Object(j.jsx)("figcaption",{className:"modal__image-caption",children:e.card.name})]})]})};var v=function(e){var t=Object(a.useState)(""),n=Object(l.a)(t,2),o=n[0],i=n[1],s=Object(a.useState)(""),r=Object(l.a)(s,2),u=r[0],d=r[1],m=c.a.useContext(_);return c.a.useEffect((function(){i(m.name),d(m.about)}),[m,e.isOpen]),Object(j.jsxs)(g,{name:"edit-profile",title:"Edit profile",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(t){t.preventDefault(),e.onUpdateUser({name:o,about:u})},children:[Object(j.jsxs)("label",{className:"form__lable",children:[Object(j.jsx)("input",{value:o||"",onChange:function(e){i(e.target.value)},id:"profile-name",type:"text",placeholder:"Name",style:{color:"#000"},className:"form__input form__input_type_title",name:"title"}),Object(j.jsx)("span",{id:"profile-name-error",className:"form__error"})]}),Object(j.jsxs)("label",{className:"form__lable",children:[Object(j.jsx)("input",{value:u||"",onChange:function(e){d(e.target.value)},id:"profile-text",type:"text",placeholder:"About me",className:"form__input form__input_type_description",name:"description",style:{color:"#000"}}),Object(j.jsx)("span",{id:"profile-text-error",className:"form__error"})]})]})};var N=function(e){var t=c.a.useRef();return Object(j.jsx)(g,{name:"avatar",title:"Change profile picture",buttonText:"Save",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(n){n.preventDefault(),e.onUpdateAvatar({avatar:t.current.value})},children:Object(j.jsxs)("label",{className:"form__lable",children:[Object(j.jsx)("input",{ref:t,id:"avatar-url",type:"url",placeholder:"Image link",className:"form__input form__input_type_url form__input_type_avatar-url",name:"link",style:{color:"#000"}}),Object(j.jsx)("span",{id:"avatar-url-error",className:"form__error"})]})})};var k=function(e){var t=c.a.useRef(),n=c.a.useRef();return Object(j.jsxs)(g,{name:"add-card",title:"New place",buttonText:"Create",isOpen:e.isOpen,onClose:e.onClose,onSubmit:function(a){a.preventDefault(),e.onAddPlace({link:t.current.value,name:n.current.value})},children:[Object(j.jsxs)("label",{className:"form__lable",children:[Object(j.jsx)("input",{ref:n,id:"card-title",type:"text",placeholder:"Title",className:"form__input form__input_type_card-title",name:"name",style:{color:"#000"}}),Object(j.jsx)("span",{id:"card-title-error",className:"form__error"})]}),Object(j.jsxs)("label",{className:"form__lable",children:[Object(j.jsx)("input",{ref:t,id:"card-url",type:"url",placeholder:"Image link",className:"form__input form__input_type_url",name:"link",style:{color:"#000"}}),Object(j.jsx)("span",{id:"card-url-error",className:"form__error"})]})]})},C=n(17),y=n(18),S=function(e){return e.ok?e.json():Promise.reject("Error: ".concat(e.status))},T=new(function(){function e(t){var n=t.baseUrl,a=t.authToken;Object(C.a)(this,e),this._baseUrl=n,this._authToken=a}return Object(y.a)(e,[{key:"getCardList",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{headers:{authorization:this._authToken}}).then(S)}},{key:"getInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{headers:{authorization:this._authToken}}).then(S)}},{key:"getInitialData",value:function(){return Promise.all([this.getInfo(),this.getCardList()])}},{key:"addCard",value:function(e){var t=e.name,n=e.link;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:n})}).then(S)}},{key:"removeCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:{authorization:this._authToken}}).then(S)}},{key:"deleteLike",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:{authorization:this._authToken}}).then(S)}},{key:"changeLikeCardStatus",value:function(e){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:this._authToken}}).then(S)}},{key:"updateUserInfo",value:function(e){var t=e.name,n=e.about;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:n})}).then(S)}},{key:"setUserAvatar",value:function(e){var t=e.avatar;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:{authorization:this._authToken,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then(S)}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/group-7",authToken:"47c83c4f-319d-4409-b351-cc8f7164bc50"}),w=function(e){var t=e.handleLogin,n=Object(a.useState)(""),c=Object(l.a)(n,2),o=c[0],i=c[1],r=Object(a.useState)(""),u=Object(l.a)(r,2),m=u[0],b=u[1];Object(d.g)();return Object(j.jsx)("div",{className:"login",children:Object(j.jsxs)("form",{className:"login__form",onSubmit:function(e){e.preventDefault(),o&&m&&t(o,m)},children:[Object(j.jsx)("p",{className:"login__title",children:"Log in"}),Object(j.jsx)("input",{className:"login__form-email login__input",name:"email",placeholder:"Email",type:"email",value:o,onChange:function(e){return i(e.target.value)}}),Object(j.jsx)("input",{className:"login__form-password login__input",name:"password",type:"password",placeholder:"Password",value:m,onChange:function(e){return b(e.target.value)}}),Object(j.jsx)("button",{style:{color:"#000"},className:"login__submit",children:"Log in"}),Object(j.jsx)("p",{className:"login__text",children:Object(j.jsxs)(s.b,{className:"login__link",to:"/signup",children:[" ","Not a member? Sign Up here"]})})]})})},E=function(e){var t=e.handleRegistration,n=Object(a.useState)(""),c=Object(l.a)(n,2),o=c[0],i=c[1],r=Object(a.useState)(""),u=Object(l.a)(r,2),d=u[0],m=u[1];return Object(j.jsx)("div",{className:"register",children:Object(j.jsxs)("form",{onSubmit:function(e){e.preventDefault(),t(d,o)},className:"register__form",children:[Object(j.jsx)("p",{className:"register__title",children:"Sign Up"}),Object(j.jsx)("input",{className:"register__form-email register__input",name:"email",placeholder:"Email",type:"email",value:d,onChange:function(e){return m(e.target.value)}}),Object(j.jsx)("input",{className:"register__form-password register__input",name:"password",type:"password",placeholder:"Password",value:o,onChange:function(e){return i(e.target.value)}}),Object(j.jsx)("button",{style:{color:"#000"},className:"register__submit",children:"Sign up"}),Object(j.jsx)("p",{className:"register__text",children:Object(j.jsxs)(s.b,{className:"register__link",to:"/signin",children:[" ","Already a member? Log in here"]})})]})})},L=n(20),U=n(21),P=function(e){var t=e.component,n=Object(U.a)(e,["component"]);return Object(j.jsx)(d.b,{children:function(){return n.loggedIn?Object(j.jsx)(t,Object(L.a)({},n)):Object(j.jsx)(d.a,{to:"./signin"})}})},A=n.p+"static/media/Success-icon.1b6082f8.svg",I=n.p+"static/media/Error-icon.df8eddf6.svg",D=function(e){return Object(j.jsx)("div",{className:"modal modal_type_".concat(e.name," ").concat(e.isOpen?"modal_open":""),children:Object(j.jsxs)("div",{className:"modal__container",children:[Object(j.jsx)("button",{className:"modal__button",type:"button","aria-label":"modal button",onClick:e.onClose}),Object(j.jsxs)("div",{action:"#",className:"modal__infotooltip",children:[Object(j.jsx)("img",{src:e.isvalidRegistration?A:I,alt:"Success Icon",className:"modal__infotooltip-icon"}),e.isvalidRegistration?Object(j.jsx)("p",{className:"modal__infotooltip-text",children:"Success! You have now been registered"}):Object(j.jsx)("p",{className:"modal__infotooltip-text",children:"Oops, something went wrong! Please try again."})]})]})})},z=function(e){return e?e.json():Promise.reject("Error: ".concat(e.status))},R="https://register.nomoreparties.co";var J=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)(!1),s=Object(l.a)(i,2),u=s[0],h=s[1],p=Object(a.useState)(!1),f=Object(l.a)(p,2),C=f[0],y=f[1],S=Object(a.useState)(!1),L=Object(l.a)(S,2),U=L[0],A=L[1],I=Object(a.useState)(!1),J=Object(l.a)(I,2),F=J[0],B=J[1],H=Object(a.useState)({}),Y=Object(l.a)(H,2),G=Y[0],M=Y[1],q=Object(a.useState)({}),K=Object(l.a)(q,2),Q=K[0],V=K[1],W=Object(a.useState)([]),X=Object(l.a)(W,2),Z=X[0],$=X[1],ee=c.a.useState(!1),te=Object(l.a)(ee,2),ne=te[0],ae=te[1],ce=Object(a.useState)(""),oe=Object(l.a)(ce,2),ie=(oe[0],oe[1]),se=Object(a.useState)(""),re=Object(l.a)(se,2),le=re[0],ue=re[1],de=Object(a.useState)(""),je=Object(l.a)(de,2),me=(je[0],je[1]),be=Object(d.g)(),he=c.a.useState(!1),pe=Object(l.a)(he,2),_e=pe[0],fe=pe[1];function Oe(){o(!1),h(!1),y(!1),A(!1),B(!1),M({})}Object(a.useEffect)((function(){ge()}),[]),Object(a.useEffect)((function(){T.getInfo().then((function(e){V(e)})).catch((function(e){console.log(e)}))}),[]),Object(a.useEffect)((function(){T.getCardList().then((function(e){$(e)})).catch((function(e){console.log(e)}))}),[]),Object(a.useEffect)((function(){var e=function(e){"Escape"===e.key&&Oe()};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}),[]);var ge=function(){if(localStorage.getItem("jwt")){var e=localStorage.getItem("jwt");(t=e,fetch("".concat(R,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}}).then(z).then((function(e){return e}))).then((function(e){e&&(ue(e.data.email),ae(!0),be.push("/")),console.log("something went wrong- tokencheck")})).catch((function(e){return console.log(e)}))}var t};return Object(j.jsx)("div",{className:"page",children:Object(j.jsx)("div",{className:"page__container",children:Object(j.jsxs)(_.Provider,{value:Q,children:[Object(j.jsx)(m,{email:le,loggedIn:ne,handleLogOut:function(){localStorage.removeItem("jwt"),ae(!1),ue(""),ie("")}}),Object(j.jsxs)(d.d,{children:[Object(j.jsx)(P,{component:O,exact:!0,path:"/",loggedIn:ne,onEditAvatarClick:function(){y(!0)},onEditProfileClick:function(){o(!0)},onAddPlaceClick:function(){h(!0)},onCardClick:function(e){var t=e.name,n=e.link;M({name:t,link:n}),A(!0)},cards:Z,onCardLike:function(e){e.likes.some((function(e){return e._id===Q._id}))?T.deleteLike(e._id).then((function(t){$((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)})):T.changeLikeCardStatus(e._id).then((function(t){$((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){T.removeCard(e._id).then((function(){var t=Z.filter((function(t){return t._id!==e._id}));$(t)})).catch((function(e){console.log(e)}))},email:le}),Object(j.jsx)(d.b,{path:"/signup",children:Object(j.jsx)(E,{handleRegistration:function(e,t){(function(e,t){return fetch("".concat(R,"/signup"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(z).then((function(e){return console.log(e),e}))})(e,t).then((function(n){if(e&&t)return fe(!0),B(!0),be.push("/signin"),n;fe(!1)})).catch((function(e){return B(!0),console.log(e),me("400 - one of the fields was filled in incorrectly")}))}})}),Object(j.jsx)(d.b,{path:"/signin",children:Object(j.jsx)(w,{handleLogin:function(e,t){(function(e,t){return fetch("".concat(R,"/signin"),{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(z).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e}))})(e,t).then((function(t){return t?t?(ue(e),ae(!0),void be.push("/")):void 0:me("one or more of the fields were not provided")})).catch((function(e){console.log(e),me(e.message)}))},tokenCheck:ge})}),Object(j.jsx)(d.b,{exact:!0,path:"/",children:ne?Object(j.jsx)(d.a,{to:"/"}):Object(j.jsx)(d.a,{to:"/signin"})})]}),ne&&Object(j.jsx)(b,{}),Object(j.jsx)(v,{isOpen:n,onClose:Oe,onUpdateUser:function(e){var t=e.name,n=e.about;T.updateUserInfo({name:t,about:n}).then((function(e){V(e),Oe()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(k,{isOpen:u,onClose:Oe,onAddPlace:function(e){var t=e.name,n=e.link;T.addCard({name:t,link:n}).then((function(e){$([e].concat(Object(r.a)(Z))),Oe()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(N,{isOpen:C,onClose:Oe,onUpdateAvatar:function(e){var t=e.avatar;T.setUserAvatar({avatar:t}).then((function(e){V(e),Oe()})).catch((function(e){console.log(e)}))}}),Object(j.jsx)(g,{name:"delete",title:"Are you sure?",buttonText:"Yes"}),Object(j.jsx)(x,{card:G,onClose:Oe,isOpen:U}),Object(j.jsx)(D,{isOpen:F,onClose:Oe,onShowToolTip:function(){B(!0)},isvalidRegistration:_e})]})})})},F=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,37)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),c(e),o(e),i(e)}))};i.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(s.a,{children:Object(j.jsx)(J,{})})}),document.getElementById("root")),F()}},[[36,1,2]]]);
//# sourceMappingURL=main.07fe5894.chunk.js.map